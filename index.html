<head>
</head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/css/reveal.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/css/theme/white.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.min.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/addon/display/fullscreen.css"/>
<style>
		code, .CodeMirror {
				tab-size: .5em;
		}
		.CodeMirror {
				font-size: .3em !important;
		}

		.CodeMirror pre {
				box-shadow: none;
		}
		.small {
				font-size: 80% !important;
		}
		.smaller {font-size: 50% !important;} .smallest {
				font-size: 35% !important;
		}
		.row {
				display: flex;
				justify-content: space-between;
				align-items: center;
		}
		#duck-tree-slide img {
				flex-shrink: 1;
				margin: 0;
				margin-right: 10px;
		}
		.run {
				margin: .5rem;
				font-size: 1rem;
				border-radius: 10px;
				padding: .3rem 1rem;
		}
</style>
<div class="reveal">
		<div class="slides">

				<section data-markdown id="main">
						# gimgen
						----
						George Mauer
						@togakangaroo - [http://georgemauer.net](http://georgemauer.net)
				</section>

				<section>
						<section id="manual-iterator-implementation-slide">
								<h1 class="smaller" >Iterators are Simple(ish)</h1>
								<div class="row">
										<textarea class="code-editor" mode="javascript" id="manual-iterator-implementation">
const manualFibbonacci = () => {
		let prev1 = 1, prev2 = 1, step = 0
		return {
				next: () => {
						if(step > 100)
								return {value: undefined, done: true};
						step += 1
						if(step <= 2)
								return {value: 1, done: false};
						[prev1, prev2] = [prev2, prev1 + prev2]
						return {value: prev2, done: false};
				}
		}
}
										</textarea>
										<figure>
												<button class="run">Run</button>
												<textarea class="code-editor" mode="javascript" data-depends="#manual-iterator-implementation">
const fib = manualFibbonacci()
console.log(fib.next())
console.log(fib.next())
console.log(fib.next())
console.log(fib.next())
												</textarea>
										</figure>
								</div>
						</section>

						<section id="manual-iterator-usage">
								<h1 class="small" >Iterators can be...well...iterated</h1>
								<button class="run">Run</button>
								<textarea class="code-editor" mode="javascript" data-depends="#manual-iterator-implementation">
		const fibIterator = manualFibbonacci()
		let x
		while((x = fibIterator.next(), !x.done))
				console.log(x.value)
								</textarea>
						</section>

						<section id="for-iterator-usage">
								<h1 class="small">Iterators can be used in loops</h1>
								<button class="run">Run</button>
								<textarea class="code-editor" mode="javascript" data-depends="#manual-iterator-implementation">
		const thingToIterate = {}
		thingToIterate[Symbol.iterator] = manualFibbonacci

		for(let val of thingToIterate)
				console.log(val)
								</textarea>
								<p>
										Yup, you can make anything iterable!
								</p>
						</section>
				</section>

				<section>
						<section id="duck-tree-slide">
								<h1 class="small">Lets talk about ducks</h1>
								<div class="row">
										<img src="img/duck-family-tree.jpg">
										<textarea class="code-editor" id="duck-tree">
												const duck = (name, children=[]) => ({name, children})
												const fergus =
												duck("Fergus", [
														duck("Matilda"),
														duck("Scrooge"),
														duck("Hortense", [
																duck("Donald"),
																duck("Della", [
																		duck("Huey"),
																		duck("Dewey"),
																		duck("Louie"),
																])
														]),
												])
										</textarea>
								</div>
						</section>

						<section id="manual-duck-iteration">
								<h1 class="small" >Iterators can flatten</h1>
								<button class="run">Run</button>
								<textarea class="code-editor" mode="javascript" data-depends="#duck-tree">
const getAllManual = (root) => {
		const stack = [root]
		return {
				next: () => {
						if(!stack.length)
								return {value: undefined, done: true}
						const value = stack.pop()
						for(let c of value.children)
								stack.push(c)
						return {value, done: false}
				}
		}
}

fergus[Symbol.iterator] = () => getAllManual(fergus)
for(let {name} of fergus)
		console.log(name)
								</textarea>
						</section>
				</section>

				<section id="generator-fibonacci">
						<h1 class="small" >generators are a simpler iterator syntax</h1>
						<div class="row">
								<figure>
										<textarea class="code-editor" mode="javascript">
const manualfibbonacci = () => {
		let prev1 = 1, prev2 = 1, step = 0
		return {
				next: () => {
						if(step > 100)
								return {value: undefined, done: true};
						step += 1
						if(step <= 2)
								return {value: 1, done: false};
						[prev1, prev2] = [prev2, prev1 + prev2]
						return {value: prev2, done: false};
				}
		}
}
										</textarea>
								</figure>
								<p>
										==
								</p>
								<figure>
										<button class="run">run</button>
										<textarea class="code-editor" mode="javascript">
const fibonacci = function * () {
		let prev1 = 1, prev2 = 1
		yield prev1
		yield prev2
		for(let i = 0; i < 98; i+=1) {
				[prev1, prev2] = [prev2, prev1 + prev2]
				yield prev2
		}
}

for(let v of fibonacci())
		console.log(v)
										</textarea>
								</figure>
						</div>
				</section>

				<section>
						<section id="generator-fibbonacci-infinite">
								<h1 class="small">Oh yeah, iterators can be infinite!</h1>
								<div class="row">
										<figure>
												<button class="run">run</button>
												<textarea class="code-editor" mode="javascript">
const manualFibbonacci = () => {
		let prev1 = 1, prev2 = 1, step = 0
		return {
				next: () => {
						step += 1
						if(step <= 2)
								return {value: 1, done: false};
						[prev1, prev2] = [prev2, prev1 + prev2]
						return {value: prev2, done: false};
				}
		}
}

const it = manualFibbonacci()
for(let i = 0; i < 100; i+=1)
		it.next()
console.log(it.next())
												</textarea>
										</figure>
										<p>
												==
										</p>
										<figure>
												<button class="run">run</button>
												<textarea class="code-editor" mode="javascript">
const fibbonacci = function * () {
		let prev1 = 1, prev2 = 1
		yield prev1
		yield prev2
		while(true) {
				[prev1, prev2] = [prev2, prev1 + prev2]
				yield prev2
		}
}

const it = fibbonacci()
for(let i = 0; i < 100; i+=1)
		it.next()
console.log(it.next())
												</textarea>
										</figure>
								</div>
						</section>

						<section id="generator-duck-iteration">
								<h1 class="small" >Flattening ducks with generators</h1>
								<button class="run">Run</button>
								<textarea class="code-editor" mode="javascript" data-depends="#duck-tree">
const getAll = function * (root) {
		yield root
		for(let c of root.children)
				yield * getAll(c)
}
for(let {name} of getAll(fergus))
	console.log(name)
								</textarea>
						</section>

						<section id="incrementing-random-number-generator-slide">
								<h1 class="small">Infinite generators are streams</h1>
								<textarea class="code-editor" mode="javascript" id="incrementing-random-number-generator">
const incrementingRandoms = function * () {
		const rand = (max, min=0) => Math.floor(Math.random() * (max - min)) + min
		let prev = 0
		while(true) {
				prev = rand(prev+1000, prev+1)
				yield prev
		}
}
								</textarea>

								<figure>
										<button class="run">run</button>
										<textarea class="code-editor" mode="javascript" data-depends="#incrementing-random-number-generator">
const it = incrementingRandoms()
for(let i = 0; i < 10; i+=1)
		console.log(it.next().value)
										</textarea>
								</figure>
						</section>
				</section>

				<section>
						<section id="you-choose-how-it-runs">
								<h1 class="small">You choose how to enumerate iterators</h1>
								<button class="run">run</button>
								<textarea class="code-editor" mode="javascript" data-depends="#incrementing-random-number-generator">
const logAndTakeEveryMs = (ms, createIterator) => {
		const it = createIterator()
		const logAndGetNext = ({done, value}) => {
				if(done) return;
				console.log(value)
				setTimeout( () => logAndGetNext(it.next()) , ms)
		}
		logAndGetNext(it.next())
}

logAndTakeEveryMs(500, incrementingRandoms)
								</textarea>
						</section>

						<section id="count-with-promises">
								<h1 class="small">Now with...promises!</h1>
								<button class="run">run</button>
								<textarea class="code-editor" mode="javascript">
const delayedIncrementingRandoms = function * () {
		const rand = (max, min=0) => Math.floor(Math.random() * (max - min)) + min
		let val = 0
		while(true) {
				val = rand(val+1000, val+1)
				console.log("Currently", val)
				yield new Promise(resolve =>
						setTimeout(() => resolve(val), 300)
				)
		}
}

const runAsync = (createIterator) => {
		const it = createIterator()
		const runNext = ({done, value: promise}) => {
				if(done) return;
				promise.then(() => runNext(it.next()))
		}
		runNext(it.next())
}

runAsync(delayedIncrementingRandoms)
								</textarea>
						</section>

						<section id="unwind-yielded-async">
								<h1 class="small">You can use this with anything async</h1>
								<textarea class="code-editor" mode="javascript">
const async = (createIterator) => (...args) => runAsync(...args)

const get = async(function * (url) {
		const result = yield fetch(url)
		return result.json()
})
const showTopRecords = async(function * () {
		const topRecords = yield get('/top-records')
		const top3Records = topRecords.slice(0, 3)
		const gettingTop3Details = top3Records.map((id) => get(`/top-records/details/${id}`))
		const topDetails = yield Promise.all(gettingTop3Details)
		const detailsHtml = template(topDetails)
		$container.detailsHtml(detailsHtml)
})
								</textarea>
						</section>

						<section id="async-is-better-or-not">
								<h1 class="small">Async...await was clearly a breakthrough</h1>
								<div class="row">
										<textarea class="code-editor" mode="javascript">
const get = async(function * (url) {
		const result = yield fetch(url)
		return result.json()
})
const showTopRecords = async(function * () {
		const topRecords = yield get('/top-records')
		const top3Records = topRecords.slice(0, 3)
		const gettingTop3Details = top3Records.map((id) => get(`/top-records/details/${id}`))
		const topDetails = yield Promise.all(gettingTop3Details)
		const detailsHtml = template(topDetails)
		$container.detailsHtml(detailsHtml)
})
										</textarea>
										<textarea class="code-editor" mode="javascript">
const get = async function (url) {
		const result = await fetch(url)
		return result.json()
}
const showTopRecords = async function () {
		const topRecords = await get('/top-records')
		const top3Records = topRecords.slice(0, 3)
		const gettingTop3Details = top3Records.map((id) => get(`/top-records/details/${id}`))
		const topDetails = await Promise.all(gettingTop3Details)
		const detailsHtml = template(topDetails)
		$container.detailsHtml(detailsHtml)
}
										</textarea>
								</div>
						</section>
				</section>

				<section id="bubble-chart">
						<h1 class="small">Requisite Functional Reactive Programming bubble chart</h1>
						<div style="display: flex; justify-content: center">
								<img src="img/bubble-chart.png" height="550" >
						</div>
						<a href="https://gist.github.com/staltz/868e7e9bc2a7b8c1f754">From this Egghead Tutorial</a>
				</section>

		</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/lib/js/head.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/js/reveal.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/keymap/vim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/addon/display/fullscreen.min.js"></script>
		<script>{
		Reveal.initialize({
				history: true,
				dependencies: [
						{ src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/plugin/highlight/highlight.min.js', async: true, callback:() => hljs.initHighlightingOnLoad() },
						{ src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/plugin/markdown/marked.js', condition:() => !!document.querySelector( '[data-markdown]' ) },
						{ src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/plugin/markdown/markdown.min.js', condition:() => !!document.querySelector( '[data-markdown]' ) },
						{ src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/plugin/zoom-js/zoom.min.js', async: true },
						{ src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.4.1/plugin/notes/notes.min.js', async: true },
				]
		});
		const codeMirrors = new Map()
		Reveal.addEventListener( 'slidechanged', ({currentSlide}) => {
				for(let el of currentSlide.querySelectorAll('.code-editor'))
						codeMirrors.get(el) && codeMirrors.get(el).refresh()
		} );

		setTimeout(() => {
				for(let el of document.querySelectorAll('.code-editor')) {
						const ed = CodeMirror.fromTextArea(el, {
								lineNumbers: true,
								keyMap: 'vim',
								extraKeys: {
										"F11": (cm) => {
												cm.setOption("fullScreen", !cm.getOption("fullScreen"))
										},
								},
						});
						ed.on('change', () => ed.save());
						codeMirrors.set(el, ed)
				}
		}, 500)
		for(let button of document.querySelectorAll('.run')) {
				const codeEl = button.nextElementSibling
				if(!codeEl.matches('.code-editor'))
						continue;
				const dependsOnEditors = !codeEl.dataset.depends ? [] : Array.from(document.querySelectorAll(codeEl.dataset.depends))
				const editorsToRun = [...dependsOnEditors, codeEl]
				button.addEventListener('click', () =>{
						const codeToRun = editorsToRun.map(ce => ce.value).join('\n;')
						console.clear()
						eval(`{
		${codeToRun}
		}`)
				})
		}
		}</script>
